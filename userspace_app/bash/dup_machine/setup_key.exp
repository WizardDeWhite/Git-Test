#!/usr/bin/expect
set ip [lindex $argv 0]
set pwd [lindex $argv 1]

spawn ssh -o "StrictHostKeyChecking no" root@$ip mkdir -p .ssh
expect {
"*assword:" { send "$pwd\r"; interact}
}
spawn scp /root/.ssh/id_rsa.pub root@$ip:/root/.ssh/authorized_keys
expect {
"*assword:" { send "$pwd\r"; interact}
}
